import{_ as Ce}from"./back-BVgbIhYC.js";import{_ as Ae}from"./topbar-DoQbFUzn.js";import{r as C,A as Se,B as Pe,b as Ie,d as je,p as G,C as Te,o as D,c as b,a as k,D as Le,E as Re,h as ae,F as J,s as oe,t as U,G as ze,j as W,y as Be,f as q}from"./index-CsNuYJGr.js";import"./ArrowLeftIcon-DlSgAoUp.js";function T(e,n,r,o){function a(t){return t instanceof r?t:new r(function(u){u(t)})}return new(r||(r=Promise))(function(t,u){function f(s){try{i(o.next(s))}catch(v){u(v)}}function p(s){try{i(o.throw(s))}catch(v){u(v)}}function i(s){s.done?t(s.value):a(s.value).then(f,p)}i((o=o.apply(e,n||[])).next())})}function L(e,n){var r={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},o,a,t,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=f(0),u.throw=f(1),u.return=f(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(i){return function(s){return p([i,s])}}function p(i){if(o)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(r=0)),r;)try{if(o=1,a&&(t=i[0]&2?a.return:i[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,i[1])).done)return t;switch(a=0,t&&(i=[i[0]&2,t.value]),i[0]){case 0:case 1:t=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(t=r.trys,!(t=t.length>0&&t[t.length-1])&&(i[0]===6||i[0]===2)){r=0;continue}if(i[0]===3&&(!t||i[1]>t[0]&&i[1]<t[3])){r.label=i[1];break}if(i[0]===6&&r.label<t[1]){r.label=t[1],t=i;break}if(t&&r.label<t[2]){r.label=t[2],r.ops.push(i);break}t[2]&&r.ops.pop(),r.trys.pop();continue}i=n.call(e,r)}catch(s){i=[6,s],a=0}finally{o=t=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}function Me(e,n){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var o=r.call(e),a,t=[],u;try{for(;(n===void 0||n-- >0)&&!(a=o.next()).done;)t.push(a.value)}catch(f){u={error:f}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(u)throw u.error}}return t}function $e(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(Me(arguments[n]));return e}var Ne=new Map([["avi","video/avi"],["gif","image/gif"],["ico","image/x-icon"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["mkv","video/x-matroska"],["mov","video/quicktime"],["mp4","video/mp4"],["pdf","application/pdf"],["png","image/png"],["zip","application/zip"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"]]);function V(e,n){var r=Ge(e);if(typeof r.path!="string"){var o=e.webkitRelativePath;Object.defineProperty(r,"path",{value:typeof n=="string"?n:typeof o=="string"&&o.length>0?o:e.name,writable:!1,configurable:!1,enumerable:!0})}return r}function Ge(e){var n=e.name,r=n&&n.lastIndexOf(".")!==-1;if(r&&!e.type){var o=n.split(".").pop().toLowerCase(),a=Ne.get(o);a&&Object.defineProperty(e,"type",{value:a,writable:!1,configurable:!1,enumerable:!0})}return e}var We=[".DS_Store","Thumbs.db"];function He(e){return T(this,void 0,void 0,function(){return L(this,function(n){return[2,Ke(e)&&e.dataTransfer?Ue(e.dataTransfer,e.type):Ve(e)]})})}function Ke(e){return!!e.dataTransfer}function Ve(e){var n=Ye(e.target)?e.target.files?Q(e.target.files):[]:[];return n.map(function(r){return V(r)})}function Ye(e){return e!==null}function Ue(e,n){return T(this,void 0,void 0,function(){var r,o;return L(this,function(a){switch(a.label){case 0:return e.items?(r=Q(e.items).filter(function(t){return t.kind==="file"}),n!=="drop"?[2,r]:[4,Promise.all(r.map(qe))]):[3,2];case 1:return o=a.sent(),[2,ie(ve(o))];case 2:return[2,ie(Q(e.files).map(function(t){return V(t)}))]}})})}function ie(e){return e.filter(function(n){return We.indexOf(n.name)===-1})}function Q(e){for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(o)}return n}function qe(e){if(typeof e.webkitGetAsEntry!="function")return le(e);var n=e.webkitGetAsEntry();return n&&n.isDirectory?pe(n):le(e)}function ve(e){return e.reduce(function(n,r){return $e(n,Array.isArray(r)?ve(r):[r])},[])}function le(e){var n=e.getAsFile();if(!n)return Promise.reject(e+" is not a File");var r=V(n);return Promise.resolve(r)}function Je(e){return T(this,void 0,void 0,function(){return L(this,function(n){return[2,e.isDirectory?pe(e):Qe(e)]})})}function pe(e){var n=e.createReader();return new Promise(function(r,o){var a=[];function t(){var u=this;n.readEntries(function(f){return T(u,void 0,void 0,function(){var p,i,s;return L(this,function(v){switch(v.label){case 0:if(f.length)return[3,5];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,Promise.all(a)];case 2:return p=v.sent(),r(p),[3,4];case 3:return i=v.sent(),o(i),[3,4];case 4:return[3,6];case 5:s=Promise.all(f.map(Je)),a.push(s),t(),v.label=6;case 6:return[2]}})})},function(f){o(f)})}t()})}function Qe(e){return T(this,void 0,void 0,function(){return L(this,function(n){return[2,new Promise(function(r,o){e.file(function(a){var t=V(a,e.fullPath);r(t)},function(a){o(a)})})]})})}var de=function(e,n){if(e&&n){var r=Array.isArray(n)?n:n.split(",");if(r.length===0)return!0;var o=e.name||"",a=(e.type||"").toLowerCase(),t=a.replace(/\/.*$/,"");return r.some(function(u){var f=u.trim().toLowerCase();return f.charAt(0)==="."?o.toLowerCase().endsWith(f):f.endsWith("/*")?t===f.replace(/\/.*$/,""):a===f})}return!0},y=function(){return y=Object.assign||function(n){for(var r,o=1,a=arguments.length;o<a;o++){r=arguments[o];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}return n},y.apply(this,arguments)};function ue(e,n){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(e);a<o.length;a++)n.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(r[o[a]]=e[o[a]]);return r}function Xe(e,n,r,o){function a(t){return t instanceof r?t:new r(function(u){u(t)})}return new(r||(r=Promise))(function(t,u){function f(s){try{i(o.next(s))}catch(v){u(v)}}function p(s){try{i(o.throw(s))}catch(v){u(v)}}function i(s){s.done?t(s.value):a(s.value).then(f,p)}i((o=o.apply(e,[])).next())})}function Ze(e,n){var r={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},o,a,t,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(i){return function(s){return p([i,s])}}function p(i){if(o)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(r=0)),r;)try{if(o=1,a&&(t=i[0]&2?a.return:i[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,i[1])).done)return t;switch(a=0,t&&(i=[i[0]&2,t.value]),i[0]){case 0:case 1:t=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,a=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(t=r.trys,!(t=t.length>0&&t[t.length-1])&&(i[0]===6||i[0]===2)){r=0;continue}if(i[0]===3&&(!t||i[1]>t[0]&&i[1]<t[3])){r.label=i[1];break}if(i[0]===6&&r.label<t[1]){r.label=t[1],t=i;break}if(t&&r.label<t[2]){r.label=t[2],r.ops.push(i);break}t[2]&&r.ops.pop(),r.trys.pop();continue}i=n.call(e,r)}catch(s){i=[6,s],a=0}finally{o=t=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}function X(e,n,r){if(r||arguments.length===2)for(var o=0,a=n.length,t;o<a;o++)(t||!(o in n))&&(t||(t=Array.prototype.slice.call(n,0,o)),t[o]=n[o]);return e.concat(t||Array.prototype.slice.call(n))}function er(e){return e.includes("MSIE")||e.includes("Trident/")}function rr(e){return e.includes("Edge/")}function nr(e){return e===void 0&&(e=window.navigator.userAgent),er(e)||rr(e)}function se(e){e.preventDefault()}function H(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(n){return n==="Files"||n==="application/x-moz-file"}):!!e.target&&!!e.target.files}function K(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}var tr="file-invalid-type",ar="file-too-large",or="file-too-small",ir="too-many-files",lr={code:ir,message:"Too many files"},ur=function(e){e=Array.isArray(e)&&e.length===1?e[0]:e;var n=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:tr,message:"File type must be ".concat(n)}};function j(e){return e!=null}var sr=de.default,cr=sr||de;function ge(e,n){var r=e.type==="application/x-moz-file"||cr(e,n);return[r,r?null:ur(n)]}var ce=function(e){return{code:ar,message:"File is larger than ".concat(e," bytes")}},fe=function(e){return{code:or,message:"File is smaller than ".concat(e," bytes")}};function me(e,n,r){if(j(e.size)&&e.size)if(j(n)&&j(r)){if(e.size>r)return[!1,ce(r)];if(e.size<n)return[!1,fe(n)]}else{if(j(n)&&e.size<n)return[!1,fe(n)];if(j(r)&&e.size>r)return[!1,ce(r)]}return[!0,null]}function O(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(r){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];return e.some(function(t){return!K(r)&&t&&t.apply(void 0,X([r],o,!1)),K(r)})}}function fr(e){var n=e.files,r=e.accept,o=e.minSize,a=e.maxSize,t=e.multiple,u=e.maxFiles;return!t&&n.length>1||t&&u>=1&&n.length>u?!1:n.every(function(f){var p=ge(f,r)[0],i=me(f,o,a)[0];return p&&i})}var vr={disabled:!1,getFilesFromEvent:He,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1};function pr(e){e===void 0&&(e={});var n=C(y(y({},vr),e));Se(function(){return y({},e)},function(l){n.value=y(y({},n.value),l)});var r=C(),o=C(),a=Pe({isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]}),t=function(){o.value&&(a.isFileDialogActive=!0,o.value.value="",o.value.click())},u=function(){var l=n.value.onFileDialogCancel;a.isFileDialogActive&&setTimeout(function(){if(o.value){var c=o.value.files;c&&!c.length&&(a.isFileDialogActive=!1,typeof l=="function"&&l())}},300)};function f(){a.isFocused=!0}function p(){a.isFocused=!1}function i(){var l=n.value.noClick;l||(nr()?setTimeout(t,0):t())}var s=C([]),v=function(l){if(r.value){var c=r.value.$el||r.value;c.contains(l.target)||(l.preventDefault(),s.value=[])}};Ie(function(){window.addEventListener("focus",u,!1);var l=n.value.preventDropOnDocument;l&&(document.addEventListener("dragover",se,!1),document.addEventListener("drop",v,!1))}),je(function(){window.removeEventListener("focus",u,!1);var l=n.value.preventDropOnDocument;l&&(document.removeEventListener("dragover",se),document.removeEventListener("drop",v))});function I(l){var c=n.value.noDragEventsBubbling;c&&l.stopPropagation()}function Z(l){return Xe(this,void 0,void 0,function(){var c,h,E,F,w;return Ze(this,function(A){switch(A.label){case 0:return c=n.value,h=c.getFilesFromEvent,E=c.noDragEventsBubbling,F=c.onDragEnter,l.preventDefault(),I(l),s.value=X(X([],s.value,!0),[l.target],!1),H(l)?h?[4,h(l)]:[2]:[3,2];case 1:if(w=A.sent(),w||(w=[]),K(l)&&!E)return[2];a.draggedFiles=w,a.isDragActive=!0,F&&F(l),A.label=2;case 2:return[2]}})})}function d(l){var c=n.value.onDragOver;if(l.preventDefault(),I(l),l.dataTransfer)try{l.dataTransfer.dropEffect="copy"}catch{}return H(l)&&c&&c(l),!1}function _(l){l.preventDefault(),I(l);var c=s.value.filter(function(F){if(!r.value)return!1;var w=r.value.$el||r.value;return w.contains(F)}),h=c.indexOf(l.target);if(h!==-1&&c.splice(h,1),s.value=c,!(c.length>0)){a.draggedFiles=[],a.isDragActive=!1;var E=n.value.onDragLeave;H(l)&&E&&E(l)}}function g(l){l.preventDefault(),I(l),s.value=[];var c=n.value,h=c.getFilesFromEvent,E=c.noDragEventsBubbling,F=c.accept,w=c.minSize,A=c.maxSize,z=c.multiple,B=c.maxFiles,M=c.onDrop,$=c.onDropRejected,N=c.onDropAccepted;if(H(l)){if(!h)return;Promise.resolve(h(l)).then(function(Ee){if(!(K(l)&&!E)){var x=[],S=[];Ee.forEach(function(P){var ne=ge(P,F),Fe=ne[0],we=ne[1],te=me(P,w,A),_e=te[0],xe=te[1];if(Fe&&_e)x.push(P);else{var Oe=[we,xe].filter(function(ke){return ke});S.push({file:P,errors:Oe})}}),(!z&&x.length>1||z&&B>=1&&x.length>B)&&(x.forEach(function(P){S.push({file:P,errors:[lr]})}),x.splice(0)),a.acceptedFiles=x,a.fileRejections=S,M&&M(x,S,l),S.length>0&&$&&$(S,l),x.length>0&&N&&N(x,l)}})}a.isFileDialogActive=!1,a.isDragActive=!1,a.draggedFiles=[],a.acceptedFiles=[],a.fileRejections=[]}var m=function(l){return n.value.disabled?void 0:l},Y=function(l){return n.value.noKeyboard?void 0:m(l)},R=function(l){return n.value.noDrag?void 0:m(l)},he=function(l){l===void 0&&(l={});var c=l.onFocus,h=l.onBlur,E=l.onClick,F=l.onDragEnter,w=l.onDragenter,A=l.onDragOver,z=l.onDragover,B=l.onDragLeave,M=l.onDragleave,$=l.onDrop,N=ue(l,["onFocus","onBlur","onClick","onDragEnter","onDragenter","onDragOver","onDragover","onDragLeave","onDragleave","onDrop"]);return y(y({onFocus:Y(O(c,f)),onBlur:Y(O(h,p)),onClick:m(O(E,i)),onDragenter:R(O(F,w,Z)),onDragover:R(O(A,z,d)),onDragleave:R(O(B,M,_)),onDrop:R(O($,g)),ref:r},!n.value.disabled&&!n.value.noKeyboard?{tabIndex:0}:{}),N)},ye=function(l){l.stopPropagation()};function De(l){l===void 0&&(l={});var c=l.onChange,h=l.onClick,E=ue(l,["onChange","onClick"]),F={accept:n.value.accept,multiple:n.value.multiple,style:"display: none",type:"file",onChange:m(O(c,g)),onClick:m(O(h,ye)),autoComplete:"off",tabIndex:-1,ref:o};return y(y({},F),E)}var ee=G(function(){return a.draggedFiles?a.draggedFiles.length:0}),re=G(function(){return ee.value>0&&fr({files:a.draggedFiles,accept:n.value.accept,minSize:n.value.minSize,maxSize:n.value.maxSize,multiple:n.value.multiple,maxFiles:n.value.maxFiles})}),be=G(function(){return ee.value>0&&!re.value});return y(y({},Te(a)),{isDragAccept:re,isDragReject:be,isFocused:G(function(){return a.isFocused&&!n.value.disabled}),getRootProps:he,getInputProps:De,rootRef:r,inputRef:o,open:m(t)})}const dr={key:0},gr=["onClick"],mr={key:1},hr={class:"flex justify-center"},yr=["disabled"],Dr={key:0,class:"error-message"},br={key:0,class:"spinner"},Er={key:1,class:"success"},Fr={key:2,class:"failed"},wr="/upload-excel/",_r={__name:"upload",setup(e){const n=C([]),r=C(""),o=C(!1),a=C([]),t=d=>{const _=["xlsx","xls"],g=d.name.split(".").pop();return _.includes(g)},u=async()=>{o.value=!0,a.value=n.value.map(()=>"uploading");for(let d=0;d<n.value.length;d++){const _=new FormData;_.append("file",n.value[d]);try{const g=await Be.post(wr,_,{headers:{"Content-Type":"multipart/form-data"}});g.data.status==="success"?a.value[d]="success":(a.value[d]="failed",r.value=g.data.error||"Invalid file structure")}catch{a.value[d]="failed",r.value="An error occurred while uploading the file."}}o.value=!1},f=(d,_)=>{n.value=[],r.value="";for(let g of d)t(g)?n.value.push(g):r.value="Only Excel files are allowed.";n.value.length===0&&(r.value="Please select at least one valid Excel file."),console.log(_)},p=d=>{n.value.splice(d,1)},i=()=>{n.value.length>0?u():r.value="Please select at least one file to upload."},{getRootProps:s,getInputProps:v,open:I,isDragActive:Z}=pr({onDrop:f});return(d,_)=>(D(),b("div",null,[k("div",ze(ae(s)(),{class:"dropzone"}),[k("input",Le(Re(ae(v)())),null,16),n.value.length>0?(D(),b("div",dr,[(D(!0),b(J,null,oe(n.value,(g,m)=>(D(),b("div",{class:"file-preview",key:m},[k("span",null,U(g.name),1),k("button",{onClick:Y=>p(m),class:"remove-button"},"x",8,gr)]))),128))])):(D(),b("p",mr,"Drag 'n' drop some files here, or click to select files"))],16),k("div",hr,[k("button",{onClick:i,class:"upload-button",disabled:n.value.length===0},"Upload Files",8,yr)]),r.value?(D(),b("div",Dr,U(r.value),1)):W("",!0),(D(!0),b(J,null,oe(n.value,(g,m)=>(D(),b("div",{key:m,class:"upload-status"},[k("span",null,U(g.name),1),a.value[m]==="uploading"?(D(),b("span",br)):W("",!0),a.value[m]==="success"?(D(),b("span",Er,"✔️")):W("",!0),a.value[m]==="failed"?(D(),b("span",Fr,"❌")):W("",!0)]))),128))]))}},xr={class:"mt-2"},Or={class:"flex justify-center items-center"},Pr={__name:"filesimport",setup(e){return(n,r)=>(D(),b(J,null,[q(Ae),k("div",xr,[q(Ce)]),k("div",Or,[q(_r)])],64))}};export{Pr as default};
