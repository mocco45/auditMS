import{r as o,l as N,c as s,f,a as t,C as D,t as n,F as c,x as d,D as j,z as S,o as l}from"./index-RCMvR-QV.js";import{_ as A}from"./topbar-HfCM6LIN.js";import{_ as M}from"./back-CVhnzYOQ.js";import{_ as z}from"./pagination-DgQ5PROv.js";import{u as F}from"./mineralYearStore-DJQpdPlK.js";const O={class:"mt-2"},U={class:"flex justify-center mb-4"},E={class:"inline-flex"},L={key:0},R={class:"mt-16"},T={class:"text-lg mb-3 ml-3 uppercase"},q={class:"table-auto text-sm text-left w-full"},G={class:"text-md text-gray-700 bg-yellow-200 dark:bg-gray-700 dark:text-gray-400"},H={class:"py-2 px-4 bg-yellow-50 border"},J={class:"mt-3 mb-4"},K={key:1},Q={class:"text-xl font-bold mb-4"},W={class:"table-auto w-full"},X={class:"border border-black px-4 py-2"},Z={class:"border border-black px-4 py-2"},tt={class:"border border-black px-4 py-2"},ut={__name:"mineralYear",setup(et){const y=o({}),i=o([]),m=o([]),v=o([]),x=o({}),p=o(!0),k=o(""),_=j().params.companyId,g=o(1),h=o(200),w=o(0),$=o(0),C=async()=>{try{const r=await S.get(`/data/company/${_}/minerals/`,{params:{page:g.value,items_per_page:h.value}}),a=await S.get(`/data/summary/year/${_}/`),e=r.data.data,u=Object.keys(e)[0];w.value=r.data.pagination.total_items,$.value=r.data.pagination.total_pages,k.value=u,y.value=e[u],v.value=a.data,i.value=new Set,m.value=Object.keys(y.value);for(const b of m.value)for(const B in y.value[b])i.value.add(B);i.value=Array.from(i.value)}catch(r){console.error(r)}};function I(r){g.value=r,C()}const P=F(),V=async()=>{await P.fetchContributionsByYearAndCompany(_),x.value=P.contributions},Y=(r,a)=>{var e;return((e=y.value[r][a])==null?void 0:e[0])||"-"};return N(async()=>{await C(),await V()}),(r,a)=>(l(),s(c,null,[f(A),t("div",O,[f(M)]),t("div",U,[t("div",E,[t("button",{onClick:a[0]||(a[0]=e=>p.value=!0),class:D([p.value?"bg-black text-white":"bg-gray-200 text-black","py-2 px-4 rounded-l-full focus:outline-none"])}," Company Data ",2),t("button",{onClick:a[1]||(a[1]=e=>p.value=!1),class:D([p.value?"bg-gray-200 text-black":"bg-black text-white","py-2 px-4 rounded-r-full focus:outline-none"])}," Distribution ",2)])]),p.value?(l(),s("div",L,[t("div",R,[t("h4",T,n(k.value),1),t("table",q,[t("thead",G,[t("tr",null,[a[2]||(a[2]=t("th",{class:"py-2 px-4 border"},"Year",-1)),(l(!0),s(c,null,d(i.value,e=>(l(),s("th",{key:e,class:"py-2 px-4 border"},n(e),1))),128))])]),t("tbody",null,[(l(!0),s(c,null,d(m.value,e=>(l(),s("tr",{class:"hover:bg-yellow-200",key:e},[t("td",H,n(e),1),(l(!0),s(c,null,d(i.value,u=>(l(),s("td",{key:u,class:"py-2 px-4 bg-yellow-50 border"},n(Y(e,u)),1))),128))]))),128))])]),f(z,{currentPage:g.value,itemsPerPage:h.value,totalItems:w.value,onPageChanged:I},null,8,["currentPage","itemsPerPage","totalItems"])]),t("div",J,[a[5]||(a[5]=t("h4",null,"Summary",-1)),t("table",null,[t("thead",null,[t("tr",null,[a[3]||(a[3]=t("th",{class:"py-2 px-4 border border-black bg-yellow-200"},"Year",-1)),(l(!0),s(c,null,d(v.value,e=>(l(),s("td",{key:e.id,class:"py-2 px-4 border border-black"},n(e.year),1))),128))])]),t("tbody",null,[t("tr",null,[a[4]||(a[4]=t("th",{class:"py-2 px-4 border border-black bg-yellow-200"},"Sum (USD)",-1)),(l(!0),s(c,null,d(v.value,e=>(l(),s("td",{key:e.id,class:"py-2 px-4 border border-slate-950"},n(e.total_value),1))),128))])])])])])):(l(),s("div",K,[(l(!0),s(c,null,d(x.value,(e,u)=>(l(),s("div",{key:u,class:"mb-8"},[t("h4",Q,n(u),1),t("table",W,[a[6]||(a[6]=t("thead",{class:"bg-yellow-200"},[t("tr",null,[t("th",{class:"px-4 py-2 border border-black"},"Mineral"),t("th",{class:"px-4 py-2 border border-black"},"Total Value(USD)"),t("th",{class:"px-4 py-2 border border-black"},"Contribution (%)")])],-1)),t("tbody",null,[(l(!0),s(c,null,d(e,b=>(l(),s("tr",{key:b.mineral},[t("td",X,n(b.mineral),1),t("td",Z,n(b.value),1),t("td",tt,n(b.contribution),1)]))),128))])])]))),128))]))],64))}};export{ut as default};
