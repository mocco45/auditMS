import{_ as O,p as T,e as j,o,c as l,f as _,r as n,J as E,b as F,a as t,k as C,t as i,F as m,s as v,j as S,y as $,h as z}from"./index-CsNuYJGr.js";import{_ as U}from"./topbar-DoQbFUzn.js";import{_ as q}from"./back-BVgbIhYC.js";import{_ as W}from"./pagination-D87BBC7m.js";import{u as J}from"./mineralYearStore-CbXuJwWx.js";import"./ArrowLeftIcon-DlSgAoUp.js";const R={__name:"BarChart",props:{companyTitle:String,dataValue:{type:Array,required:!0},dataYears:{type:Array,required:!0}},setup(f){const r=f,d=T(()=>r.dataValue.map(s=>({mineral:s.mineral,value:s.value.map(g=>g[0])}))),b=T(()=>{if(!r.dataValue||!Array.isArray(r.dataValue)||r.dataValue.length===0)throw new Error("Invalid or empty 'dataValue' prop");if(!r.dataYears||!Array.isArray(r.dataYears)||r.dataYears.length===0)throw new Error("Invalid or empty 'years' prop");return{title:{text:r.companyTitle||"Minerals Over the Years",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"category",data:r.dataYears,name:"Time (year)",nameLocation:"middle",nameTextStyle:{fontWeight:"bold",fontSize:14,padding:20},axisLabel:{rotate:45,interval:0}},yAxis:{type:"value",name:"Mineral Value (USD)",nameLocation:"middle",nameTextStyle:{fontWeight:"bold",fontSize:14,padding:70},axisLabel:{formatter:s=>s.toLocaleString()}},series:d.value.map(s=>({name:s.mineral,type:"bar",data:s.value}))}});return(s,g)=>{const u=j("v-chart");return o(),l("div",null,[_(u,{class:"chart",option:b.value},null,8,["option"])])}}},G=O(R,[["__scopeId","data-v-4271b14b"]]);function H(){return{formatThousands:r=>(console.log("lets see",r),typeof r!="number"?r:r.toLocaleString())}}const K={class:"mt-2"},Q={class:"flex justify-center mb-4"},X={class:"inline-flex"},Z={key:0},tt={class:"mt-16"},at={class:"text-lg mb-3 ml-3 uppercase"},et={class:"table-auto text-sm text-left w-full"},rt={class:"text-md text-gray-700 bg-yellow-200 dark:bg-gray-700 dark:text-gray-400"},ot={class:"py-2 px-4 bg-yellow-50 border"},lt={class:"mt-3 mb-4"},st={key:1},nt={class:"text-xl font-bold mb-4"},ut={class:"table-auto w-full"},it={class:"border border-black px-4 py-2"},dt={class:"border border-black px-4 py-2"},ct={class:"border border-black px-4 py-2"},pt={key:2},xt={__name:"mineralYear",setup(f){const r=n({}),d=n([]),b=n([]),s=n([]),g=n({}),u=n("companyData"),x=n(""),h=E().params.companyId,k=n(1),V=n(200),D=n(0),L=n(0),P=n([]),{formatThousands:A}=H(),Y=async()=>{try{const p=await $.get(`/data/summary/year/${h}/`),e=await $.get(`/data/company/${h}/minerals/`,{params:{page:k.value,items_per_page:V.value}}),a=e.data.data,y=Object.keys(a)[0];D.value=e.data.pagination.total_items,L.value=e.data.pagination.total_pages,x.value=y,r.value=a[y],s.value=p.data,d.value=new Set,b.value=Object.keys(r.value);for(const c of b.value)for(const w in r.value[c])d.value.add(w);P.value=Array.from(d.value).map(c=>({mineral:c,value:b.value.map(w=>r.value[w][c]||0)})),d.value=Array.from(d.value)}catch(p){console.error(p)}};function B(p){k.value=p,Y()}const I=J(),M=async()=>{await I.fetchContributionsByYearAndCompany(h),g.value=I.contributions},N=(p,e)=>{var a;return((a=r.value[p][e])==null?void 0:a[0])||"-"};return F(async()=>{await Y(),await M()}),(p,e)=>(o(),l(m,null,[_(U),t("div",K,[_(q)]),t("div",Q,[t("div",X,[t("button",{onClick:e[0]||(e[0]=a=>u.value="companyData"),class:C([u.value==="companyData"?"bg-black text-white":"bg-gray-200 text-black","py-2 px-4 rounded-l-full focus:outline-none"])}," Company Data ",2),t("button",{onClick:e[1]||(e[1]=a=>u.value="distribution"),class:C([u.value==="distribution"?"bg-black text-white":"bg-gray-200 text-black","py-2 px-4 focus:outline-none"])}," Distribution ",2),t("button",{onClick:e[2]||(e[2]=a=>u.value="visualize"),class:C([u.value==="visualize"?"bg-black text-white":"bg-gray-200 text-black","py-2 px-4 rounded-r-full focus:outline-none"])}," visualize ",2)])]),u.value==="companyData"?(o(),l("div",Z,[t("div",tt,[t("h4",at,i(x.value),1),t("table",et,[t("thead",rt,[t("tr",null,[e[3]||(e[3]=t("th",{class:"py-2 px-4 border"},"Year",-1)),(o(!0),l(m,null,v(d.value,a=>(o(),l("th",{key:a,class:"py-2 px-4 border"},i(a),1))),128))])]),t("tbody",null,[(o(!0),l(m,null,v(b.value,a=>(o(),l("tr",{class:"hover:bg-yellow-200",key:a},[t("td",ot,i(a),1),(o(!0),l(m,null,v(d.value,y=>(o(),l("td",{key:y,class:"py-2 px-4 bg-yellow-50 border"},i(N(a,y)),1))),128))]))),128))])]),_(W,{currentPage:k.value,itemsPerPage:V.value,totalItems:D.value,onPageChanged:B},null,8,["currentPage","itemsPerPage","totalItems"])]),t("div",lt,[e[6]||(e[6]=t("h4",null,"Summary",-1)),t("table",null,[t("thead",null,[t("tr",null,[e[4]||(e[4]=t("th",{class:"py-2 px-4 border border-black bg-yellow-200"},"Year",-1)),(o(!0),l(m,null,v(s.value,a=>(o(),l("td",{key:a.id,class:"py-2 px-4 border border-black"},i(a.year),1))),128))])]),t("tbody",null,[t("tr",null,[e[5]||(e[5]=t("th",{class:"py-2 px-4 border border-black bg-yellow-200"},"Sum (USD)",-1)),(o(!0),l(m,null,v(s.value,a=>(o(),l("td",{key:a.id,class:"py-2 px-4 border border-slate-950"},i(z(A)(parseInt(a.total_value))),1))),128))])])])])])):S("",!0),u.value==="distribution"?(o(),l("div",st,[(o(!0),l(m,null,v(g.value,(a,y)=>(o(),l("div",{key:y,class:"mb-8"},[t("h4",nt,i(y),1),t("table",ut,[e[7]||(e[7]=t("thead",{class:"bg-yellow-200"},[t("tr",null,[t("th",{class:"px-4 py-2 border border-black"},"Mineral"),t("th",{class:"px-4 py-2 border border-black"},"Total Value(USD)"),t("th",{class:"px-4 py-2 border border-black"},"Contribution (%)")])],-1)),t("tbody",null,[(o(!0),l(m,null,v(a,c=>(o(),l("tr",{key:c.mineral},[t("td",it,i(c.mineral),1),t("td",dt,i(z(A)(parseInt(c.value))),1),t("td",ct,i(c.contribution),1)]))),128))])])]))),128))])):S("",!0),u.value==="visualize"?(o(),l("div",pt,[_(G,{"company-title":x.value,"data-years":b.value,"data-value":P.value},null,8,["company-title","data-years","data-value"])])):S("",!0)],64))}};export{xt as default};
